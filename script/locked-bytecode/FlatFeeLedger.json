{"abi":[{"type":"constructor","inputs":[{"name":"ledgerConfiguration_","type":"address","internalType":"address"},{"name":"allowedExecutors_","type":"address[]","internalType":"address[]"}],"stateMutability":"nonpayable"},{"type":"function","name":"allowedExecutors","inputs":[{"name":"executor","type":"address","internalType":"address"}],"outputs":[{"name":"isAllowed","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"calculateCostBasisView","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"yieldSource","type":"address","internalType":"address"},{"name":"usedShares","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"costBasis","type":"uint256","internalType":"uint256"},{"name":"shares","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"previewFees","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"yieldSourceAddress","type":"address","internalType":"address"},{"name":"amountAssets","type":"uint256","internalType":"uint256"},{"name":"usedShares","type":"uint256","internalType":"uint256"},{"name":"feePercent","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"feeAmount","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"superLedgerConfiguration","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract SuperLedgerConfiguration"}],"stateMutability":"view"},{"type":"function","name":"updateAccounting","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"yieldSource","type":"address","internalType":"address"},{"name":"yieldSourceOracleId","type":"bytes32","internalType":"bytes32"},{"name":"isInflow","type":"bool","internalType":"bool"},{"name":"amountSharesOrAssets","type":"uint256","internalType":"uint256"},{"name":"usedShares","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"feeAmount","type":"uint256","internalType":"uint256"}],"stateMutability":"nonpayable"},{"type":"function","name":"usersAccumulatorCostBasis","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"yieldSource","type":"address","internalType":"address"}],"outputs":[{"name":"costBasis","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"usersAccumulatorShares","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"yieldSource","type":"address","internalType":"address"}],"outputs":[{"name":"shares","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"event","name":"AccountingInflow","inputs":[{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"yieldSourceOracle","type":"address","indexed":true,"internalType":"address"},{"name":"yieldSource","type":"address","indexed":true,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"pps","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"AccountingOutflow","inputs":[{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"yieldSourceOracle","type":"address","indexed":true,"internalType":"address"},{"name":"yieldSource","type":"address","indexed":true,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"feeAmount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"UsedSharesCapped","inputs":[{"name":"originalVal","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"cappedVal","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"error","name":"FEE_NOT_SET","inputs":[]},{"type":"error","name":"HOOK_NOT_FOUND","inputs":[]},{"type":"error","name":"INVALID_FEE_PERCENT","inputs":[]},{"type":"error","name":"INVALID_LEDGER","inputs":[]},{"type":"error","name":"INVALID_PRICE","inputs":[]},{"type":"error","name":"MANAGER_NOT_SET","inputs":[]},{"type":"error","name":"NOT_AUTHORIZED","inputs":[]},{"type":"error","name":"NOT_MANAGER","inputs":[]},{"type":"error","name":"ZERO_ADDRESS_NOT_ALLOWED","inputs":[]},{"type":"error","name":"ZERO_ID_NOT_ALLOWED","inputs":[]},{"type":"error","name":"ZERO_LENGTH","inputs":[]}],"bytecode":{"object":"0x60a060405234801561000f575f5ffd5b50604051610baf380380610baf83398101604081905261002e916100fa565b81816001600160a01b03821661005757604051636fe7b73760e01b815260040160405180910390fd5b6001600160a01b03821660805280515f5b818110156100c057600160025f858481518110610087576100876101d8565b6020908102919091018101516001600160a01b031682528101919091526040015f20805460ff1916911515919091179055600101610068565b5050505050506101ec565b80516001600160a01b03811681146100e1575f5ffd5b919050565b634e487b7160e01b5f52604160045260245ffd5b5f5f6040838503121561010b575f5ffd5b610114836100cb565b60208401519092506001600160401b0381111561012f575f5ffd5b8301601f8101851361013f575f5ffd5b80516001600160401b03811115610158576101586100e6565b604051600582901b90603f8201601f191681016001600160401b0381118282101715610186576101866100e6565b6040529182526020818401810192908101888411156101a3575f5ffd5b6020850194505b838510156101c9576101bb856100cb565b8152602094850194016101aa565b50809450505050509250929050565b634e487b7160e01b5f52603260045260245ffd5b6080516109a461020b5f395f818161010201526103a201526109a45ff3fe608060405234801561000f575f5ffd5b506004361061007a575f3560e01c8063825e9ec711610058578063825e9ec7146100fd578063e4367cd31461013c578063e70833d314610164578063fd8cd53f1461018e575f5ffd5b80632c119fca1461007e57806337cb6736146100b857806349b1df7b146100ea575b5f5ffd5b6100a561008c366004610742565b5f60208181529281526040808220909352908152205481565b6040519081526020015b60405180910390f35b6100da6100c6366004610779565b60026020525f908152604090205460ff1681565b60405190151581526020016100af565b6100a56100f8366004610794565b6101a1565b6101247f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016100af565b61014f61014a3660046107e1565b6101c7565b604080519283526020830191909152016100af565b6100a5610172366004610742565b600160209081525f928352604080842090915290825290205481565b6100a561019c36600461081f565b610235565b5f5f6101ae8787866101c7565b5090506101bc818685610251565b979650505050505050565b6001600160a01b038084165f8181526020818152604080832094871680845294825280832054938352600182528083209483529390529182205482919081851115610210578194505b5f851161021d575f610228565b6102288186846102aa565b9794965093945050505050565b5f61024487878787878761035b565b90505b9695505050505050565b5f5f848411610260575f61026a565b61026a8585610884565b905080156102a257825f0361029257604051632e069cd360e01b815260040160405180910390fd5b61029f81846127106102aa565b91505b509392505050565b5f5f5f6102b786866106d7565b91509150815f036102db578381816102d1576102d16108a9565b0492505050610354565b8184116102f2576102f260038515026011186106f3565b5f848688095f868103871696879004966002600389028118808a02820302808a02820302808a02820302808a02820302808a02820302808a02909103029181900381900460010185841190960395909502919093039390930492909217029150505b9392505050565b335f9081526002602052604081205460ff1661038a57604051633d83866f60e01b815260040160405180910390fd5b604051630b47673760e41b8152600481018690525f907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063b47673709060240160a060405180830381865afa1580156103ef573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061041391906108cd565b60608101519091506001600160a01b031661044157604051638077659960e01b815260040160405180910390fd5b60808101516001600160a01b0316301461046e57604051632a076cc160e11b815260040160405180910390fd5b805160405163ec422afd60e01b81526001600160a01b0389811660048301525f92169063ec422afd90602401602060405180830381865afa1580156104b5573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104d99190610960565b9050805f036104fb576040516325f9ce5d60e11b815260040160405180910390fd5b85156105d1578151604051636a24d41960e11b81526001600160a01b03808b16600483015261057e928c9289928d92879291169063d449a83290602401602060405180830381865afa158015610553573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906105779190610977565b5050505050565b815160408051878152602081018490526001600160a01b03808c1693811692908d16917f0739bc8e7ea8aa32e4aed717e94d5448d6c652c3d2c346961880a6878b9a2247910160405180910390a46106cb565b8151604051636a24d41960e11b81526001600160a01b038a811660048301525f9261064f9289928992879291169063d449a83290602401602060405180830381865afa158015610623573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906106479190610977565b509192915050565b905061065e8a8a838887610704565b9350886001600160a01b0316835f01516001600160a01b03168b6001600160a01b03167fc1eb34142f486694077c8fe62a1e5ea0af28fa50ecb14190c84a7f60ffbb05fd89886040516106bb929190918252602082015260400190565b60405180910390a4505050610247565b50509695505050505050565b5f805f1983850993909202808410938190039390930393915050565b634e487b715f52806020526024601cfd5b60208101515f90156107225761071f5f858460200151610251565b90505b95945050505050565b6001600160a01b038116811461073f575f5ffd5b50565b5f5f60408385031215610753575f5ffd5b823561075e8161072b565b9150602083013561076e8161072b565b809150509250929050565b5f60208284031215610789575f5ffd5b81356103548161072b565b5f5f5f5f5f60a086880312156107a8575f5ffd5b85356107b38161072b565b945060208601356107c38161072b565b94979496505050506040830135926060810135926080909101359150565b5f5f5f606084860312156107f3575f5ffd5b83356107fe8161072b565b9250602084013561080e8161072b565b929592945050506040919091013590565b5f5f5f5f5f5f60c08789031215610834575f5ffd5b863561083f8161072b565b9550602087013561084f8161072b565b9450604087013593506060870135801515811461086a575f5ffd5b9598949750929560808101359460a0909101359350915050565b818103818111156108a357634e487b7160e01b5f52601160045260245ffd5b92915050565b634e487b7160e01b5f52601260045260245ffd5b80516108c88161072b565b919050565b5f60a08284031280156108de575f5ffd5b5060405160a0810167ffffffffffffffff8111828210171561090e57634e487b7160e01b5f52604160045260245ffd5b60405261091a836108bd565b815260208381015190820152610932604084016108bd565b6040820152610943606084016108bd565b6060820152610954608084016108bd565b60808201529392505050565b5f60208284031215610970575f5ffd5b5051919050565b5f60208284031215610987575f5ffd5b815160ff81168114610354575f5ffdfea164736f6c634300081e000a","sourceMap":"610:1754:324:-:0;;;924:167;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1043:20;1065:17;-1:-1:-1;;;;;2644:39:323;;2640:78;;2692:26;;-1:-1:-1;;;2692:26:323;;;;;;;;;;;2640:78;-1:-1:-1;;;;;2728:78:323;;;;2830:24;;2816:11;2864:100;2884:3;2880:1;:7;2864:100;;;2949:4;2908:16;:38;2925:17;2943:1;2925:20;;;;;;;;:::i;:::-;;;;;;;;;;;;-1:-1:-1;;;;;2908:38:323;;;;;;;;;;;-1:-1:-1;2908:38:323;:45;;-1:-1:-1;;2908:45:323;;;;;;;;;;-1:-1:-1;2889:3:323;2864:100;;;;2630:340;2547:423;;924:167:324;;610:1754;;14:177:635;93:13;;-1:-1:-1;;;;;135:31:635;;125:42;;115:70;;181:1;178;171:12;115:70;14:177;;;:::o;196:127::-;257:10;252:3;248:20;245:1;238:31;288:4;285:1;278:15;312:4;309:1;302:15;328:1220;432:6;440;493:2;481:9;472:7;468:23;464:32;461:52;;;509:1;506;499:12;461:52;532:40;562:9;532:40;:::i;:::-;616:2;601:18;;595:25;522:50;;-1:-1:-1;;;;;;632:30:635;;629:50;;;675:1;672;665:12;629:50;698:22;;751:4;743:13;;739:27;-1:-1:-1;729:55:635;;780:1;777;770:12;729:55;807:9;;-1:-1:-1;;;;;828:30:635;;825:56;;;861:18;;:::i;:::-;943:2;937:9;904:1;900:14;;;;997:2;989:11;;-1:-1:-1;;985:25:635;973:38;;-1:-1:-1;;;;;1026:34:635;;1062:22;;;1023:62;1020:88;;;1088:18;;:::i;:::-;1124:2;1117:22;1174;;;1224:2;1254:11;;;1250:20;;;1174:22;1212:15;;1282:19;;;1279:39;;;1314:1;1311;1304:12;1279:39;1346:2;1342;1338:11;1327:22;;1358:159;1374:6;1369:3;1366:15;1358:159;;;1440:34;1470:3;1440:34;:::i;:::-;1428:47;;1504:2;1391:12;;;;1495;1358:159;;;1362:3;1536:6;1526:16;;;;;;328:1220;;;;;:::o;1553:127::-;1614:10;1609:3;1605:20;1602:1;1595:31;1645:4;1642:1;1635:15;1669:4;1666:1;1659:15;1553:127;610:1754:324;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061007a575f3560e01c8063825e9ec711610058578063825e9ec7146100fd578063e4367cd31461013c578063e70833d314610164578063fd8cd53f1461018e575f5ffd5b80632c119fca1461007e57806337cb6736146100b857806349b1df7b146100ea575b5f5ffd5b6100a561008c366004610742565b5f60208181529281526040808220909352908152205481565b6040519081526020015b60405180910390f35b6100da6100c6366004610779565b60026020525f908152604090205460ff1681565b60405190151581526020016100af565b6100a56100f8366004610794565b6101a1565b6101247f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016100af565b61014f61014a3660046107e1565b6101c7565b604080519283526020830191909152016100af565b6100a5610172366004610742565b600160209081525f928352604080842090915290825290205481565b6100a561019c36600461081f565b610235565b5f5f6101ae8787866101c7565b5090506101bc818685610251565b979650505050505050565b6001600160a01b038084165f8181526020818152604080832094871680845294825280832054938352600182528083209483529390529182205482919081851115610210578194505b5f851161021d575f610228565b6102288186846102aa565b9794965093945050505050565b5f61024487878787878761035b565b90505b9695505050505050565b5f5f848411610260575f61026a565b61026a8585610884565b905080156102a257825f0361029257604051632e069cd360e01b815260040160405180910390fd5b61029f81846127106102aa565b91505b509392505050565b5f5f5f6102b786866106d7565b91509150815f036102db578381816102d1576102d16108a9565b0492505050610354565b8184116102f2576102f260038515026011186106f3565b5f848688095f868103871696879004966002600389028118808a02820302808a02820302808a02820302808a02820302808a02820302808a02909103029181900381900460010185841190960395909502919093039390930492909217029150505b9392505050565b335f9081526002602052604081205460ff1661038a57604051633d83866f60e01b815260040160405180910390fd5b604051630b47673760e41b8152600481018690525f907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063b47673709060240160a060405180830381865afa1580156103ef573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061041391906108cd565b60608101519091506001600160a01b031661044157604051638077659960e01b815260040160405180910390fd5b60808101516001600160a01b0316301461046e57604051632a076cc160e11b815260040160405180910390fd5b805160405163ec422afd60e01b81526001600160a01b0389811660048301525f92169063ec422afd90602401602060405180830381865afa1580156104b5573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104d99190610960565b9050805f036104fb576040516325f9ce5d60e11b815260040160405180910390fd5b85156105d1578151604051636a24d41960e11b81526001600160a01b03808b16600483015261057e928c9289928d92879291169063d449a83290602401602060405180830381865afa158015610553573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906105779190610977565b5050505050565b815160408051878152602081018490526001600160a01b03808c1693811692908d16917f0739bc8e7ea8aa32e4aed717e94d5448d6c652c3d2c346961880a6878b9a2247910160405180910390a46106cb565b8151604051636a24d41960e11b81526001600160a01b038a811660048301525f9261064f9289928992879291169063d449a83290602401602060405180830381865afa158015610623573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906106479190610977565b509192915050565b905061065e8a8a838887610704565b9350886001600160a01b0316835f01516001600160a01b03168b6001600160a01b03167fc1eb34142f486694077c8fe62a1e5ea0af28fa50ecb14190c84a7f60ffbb05fd89886040516106bb929190918252602082015260400190565b60405180910390a4505050610247565b50509695505050505050565b5f805f1983850993909202808410938190039390930393915050565b634e487b715f52806020526024601cfd5b60208101515f90156107225761071f5f858460200151610251565b90505b95945050505050565b6001600160a01b038116811461073f575f5ffd5b50565b5f5f60408385031215610753575f5ffd5b823561075e8161072b565b9150602083013561076e8161072b565b809150509250929050565b5f60208284031215610789575f5ffd5b81356103548161072b565b5f5f5f5f5f60a086880312156107a8575f5ffd5b85356107b38161072b565b945060208601356107c38161072b565b94979496505050506040830135926060810135926080909101359150565b5f5f5f606084860312156107f3575f5ffd5b83356107fe8161072b565b9250602084013561080e8161072b565b929592945050506040919091013590565b5f5f5f5f5f5f60c08789031215610834575f5ffd5b863561083f8161072b565b9550602087013561084f8161072b565b9450604087013593506060870135801515811461086a575f5ffd5b9598949750929560808101359460a0909101359350915050565b818103818111156108a357634e487b7160e01b5f52601160045260245ffd5b92915050565b634e487b7160e01b5f52601260045260245ffd5b80516108c88161072b565b919050565b5f60a08284031280156108de575f5ffd5b5060405160a0810167ffffffffffffffff8111828210171561090e57634e487b7160e01b5f52604160045260245ffd5b60405261091a836108bd565b815260208381015190820152610932604084016108bd565b6040820152610943606084016108bd565b6060820152610954608084016108bd565b60808201529392505050565b5f60208284031215610970575f5ffd5b5051919050565b5f60208284031215610987575f5ffd5b815160ff81168114610354575f5ffdfea164736f6c634300081e000a","sourceMap":"610:1754:324:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1358:101:323;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;689:25:635;;;677:2;662:18;1358:101:323;;;;;;;;1936:67;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;1142:14:635;;1135:22;1117:41;;1105:2;1090:18;1936:67:323;977:187:635;4395:412:323;;;;;;:::i;:::-;;:::i;1118:66::-;;;;;;;;-1:-1:-1;;;;;2123:32:635;;;2105:51;;2093:2;2078:18;1118:66:323;1924:238:635;3697:659:323;;;;;;:::i;:::-;;:::i;:::-;;;;2854:25:635;;;2910:2;2895:18;;2888:34;;;;2827:18;3697:659:323;2680:248:635;1667:107:323;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;3267:391;;;;;;:::i;:::-;;:::i;4395:412::-;4611:17;4645;4667:60;4690:4;4696:18;4716:10;4667:22;:60::i;:::-;4644:83;;;4749:51;4764:9;4775:12;4789:10;4749:14;:51::i;:::-;4737:63;4395:412;-1:-1:-1;;;;;;;4395:412:323:o;3697:659::-;-1:-1:-1;;;;;3939:28:323;;;3859:17;3939:28;;;;;;;;;;;:41;;;;;;;;;;;;;4021:31;;;:25;:31;;;;;:44;;;;;;;;;;3859:17;;3939:41;4080:30;;;4076:137;;;4185:17;4172:30;;4076:137;4248:1;4235:10;:14;:85;;4319:1;4235:85;;;4252:64;4264:20;4286:10;4298:17;4252:11;:64::i;:::-;4223:97;4339:10;;-1:-1:-1;3697:659:323;;-1:-1:-1;;;;;3697:659:323:o;3267:391::-;3510:17;3550:101;3568:4;3574:11;3587:19;3608:8;3618:20;3640:10;3550:17;:101::i;:::-;3543:108;;3267:391;;;;;;;;;:::o;9382:446::-;9560:17;9593:14;9625:9;9610:12;:24;:55;;9664:1;9610:55;;;9637:24;9652:9;9637:12;:24;:::i;:::-;9593:72;-1:-1:-1;9679:10:323;;9675:147;;9709:10;9723:1;9709:15;9705:41;;9733:13;;-1:-1:-1;;;9733:13:323;;;;;;;;;;;9705:41;9772:39;9784:6;9792:10;9804:6;9772:11;:39::i;:::-;9760:51;;9675:147;9583:245;9382:446;;;;;:::o;7242:3683:253:-;7324:14;7375:12;7389:11;7404:12;7411:1;7414;7404:6;:12::i;:::-;7374:42;;;;7498:4;7506:1;7498:9;7494:365;;7833:11;7827:3;:17;;;;;:::i;:::-;;7820:24;;;;;;7494:365;7984:4;7969:11;:19;7965:142;;8008:84;5312:5;8028:16;;5311:36;940:4:244;5306:42:253;8008:11;:84::i;:::-;8359:17;8510:11;8507:1;8504;8497:25;8902:12;8932:15;;;8917:31;;9067:22;;;;;9800:1;9781;:15;;9780:21;;10033;;;10029:25;;10018:36;10103:21;;;10099:25;;10088:36;10175:21;;;10171:25;;10160:36;10246:21;;;10242:25;;10231:36;10319:21;;;10315:25;;10304:36;10393:21;;;10389:25;;;10378:36;9309:12;;;;9305:23;;;9330:1;9301:31;8622:18;;;8612:29;;;9416:11;;;;8665:19;;;;9160:14;;;;9409:18;;;;10868:13;;-1:-1:-1;;7242:3683:253;;;;;;:::o;10844:1668:323:-;3174:10;11125:17;12914:26;;;:16;:26;;;;;;;;3150:60;;3194:16;;-1:-1:-1;;;3194:16:323;;;;;;;;;;;3150:60;11236:72:::1;::::0;-1:-1:-1;;;11236:72:323;;::::1;::::0;::::1;689:25:635::0;;;11158:63:323::1;::::0;11236:24:::1;-1:-1:-1::0;;;;;11236:51:323::1;::::0;::::1;::::0;662:18:635;;11236:72:323::1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;11323:14;::::0;::::1;::::0;11158:150;;-1:-1:-1;;;;;;11323:28:323::1;11319:58;;11360:17;;-1:-1:-1::0;;;11360:17:323::1;;;;;;;;;;;11319:58;11391:13;::::0;::::1;::::0;-1:-1:-1;;;;;11391:30:323::1;11416:4;11391:30;11387:59;;11430:16;;-1:-1:-1::0;;;11430:16:323::1;;;;;;;;;;;11387:59;11523:24:::0;;11504:74:::1;::::0;-1:-1:-1;;;11504:74:323;;-1:-1:-1;;;;;2123:32:635;;;11504:74:323::1;::::0;::::1;2105:51:635::0;11490:11:323::1;::::0;11504:61:::1;::::0;::::1;::::0;2078:18:635;;11504:74:323::1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;11490:88;;11592:3;11599:1;11592:8:::0;11588:36:::1;;11609:15;;-1:-1:-1::0;;;11609:15:323::1;;;;;;;;;;;11588:36;11639:8;11635:871;;;11823:24:::0;;11804:66:::1;::::0;-1:-1:-1;;;11804:66:323;;-1:-1:-1;;;;;2123:32:635;;;11804:66:323::1;::::0;::::1;2105:51:635::0;11663:221:323::1;::::0;11694:4;;11716:20;;11754:11;;11783:3;;11804:53;::::1;::::0;::::1;::::0;2078:18:635;;11804:66:323::1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;11663:221:::0;1097:139:324;;;;;11663:221:323::1;11927:24:::0;;11904:88:::1;::::0;;2854:25:635;;;2910:2;2895:18;;2888:34;;;-1:-1:-1;;;;;11904:88:323;;::::1;::::0;;::::1;::::0;;;::::1;::::0;::::1;::::0;2827:18:635;11904:88:323::1;;;;;;;11635:871;;;12194:24:::0;;12175:66:::1;::::0;-1:-1:-1;;;12175:66:323;;-1:-1:-1;;;;;2123:32:635;;;12175:66:323::1;::::0;::::1;2105:51:635::0;12023:20:323::1;::::0;12046:209:::1;::::0;12088:20;;12126:10;;12154:3;;12175:53;::::1;::::0;::::1;::::0;2078:18:635;;12175:66:323::1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1::0;6533:20:323;;6313:247;-1:-1:-1;;6313:247:323;12046:209:::1;12023:232;;12282:68;12298:4;12304:11;12317:12;12331:10;12343:6;12282:15;:68::i;:::-;12270:80;;12420:11;-1:-1:-1::0;;;;;12370:95:323::1;12394:6;:24;;;-1:-1:-1::0;;;;;12370:95:323::1;12388:4;-1:-1:-1::0;;;;;12370:95:323::1;;12433:20;12455:9;12370:95;;;;;;2854:25:635::0;;;2910:2;2895:18;;2888:34;2842:2;2827:18;;2680:248;12370:95:323::1;;;;;;;;12479:16;;;;;11635:871;11148:1364;;10844:1668:::0;;;;;;;;:::o;1027:550:253:-;1088:12;;-1:-1:-1;;1471:1:253;1468;1461:20;1501:9;;;;1549:11;;;1535:12;;;;1531:30;;;;;1027:550;-1:-1:-1;;1027:550:253:o;1776:194:244:-;1881:10;1875:4;1868:24;1918:4;1912;1905:18;1949:4;1943;1936:18;1809:553:324;2246:17;;;;2061;;2246:21;2242:114;;2295:50;2310:1;2313:12;2327:6;:17;;;2295:14;:50::i;:::-;2283:62;;2242:114;1809:553;;;;;;;:::o;14:131:635:-;-1:-1:-1;;;;;89:31:635;;79:42;;69:70;;135:1;132;125:12;69:70;14:131;:::o;150:388::-;218:6;226;279:2;267:9;258:7;254:23;250:32;247:52;;;295:1;292;285:12;247:52;334:9;321:23;353:31;378:5;353:31;:::i;:::-;403:5;-1:-1:-1;460:2:635;445:18;;432:32;473:33;432:32;473:33;:::i;:::-;525:7;515:17;;;150:388;;;;;:::o;725:247::-;784:6;837:2;825:9;816:7;812:23;808:32;805:52;;;853:1;850;843:12;805:52;892:9;879:23;911:31;936:5;911:31;:::i;1169:750::-;1264:6;1272;1280;1288;1296;1349:3;1337:9;1328:7;1324:23;1320:33;1317:53;;;1366:1;1363;1356:12;1317:53;1405:9;1392:23;1424:31;1449:5;1424:31;:::i;:::-;1474:5;-1:-1:-1;1531:2:635;1516:18;;1503:32;1544:33;1503:32;1544:33;:::i;:::-;1169:750;;1596:7;;-1:-1:-1;;;;1676:2:635;1661:18;;1648:32;;1779:2;1764:18;;1751:32;;1882:3;1867:19;;;1854:33;;-1:-1:-1;1169:750:635:o;2167:508::-;2244:6;2252;2260;2313:2;2301:9;2292:7;2288:23;2284:32;2281:52;;;2329:1;2326;2319:12;2281:52;2368:9;2355:23;2387:31;2412:5;2387:31;:::i;:::-;2437:5;-1:-1:-1;2494:2:635;2479:18;;2466:32;2507:33;2466:32;2507:33;:::i;:::-;2167:508;;2559:7;;-1:-1:-1;;;2639:2:635;2624:18;;;;2611:32;;2167:508::o;2933:868::-;3034:6;3042;3050;3058;3066;3074;3127:3;3115:9;3106:7;3102:23;3098:33;3095:53;;;3144:1;3141;3134:12;3095:53;3183:9;3170:23;3202:31;3227:5;3202:31;:::i;:::-;3252:5;-1:-1:-1;3309:2:635;3294:18;;3281:32;3322:33;3281:32;3322:33;:::i;:::-;3374:7;-1:-1:-1;3428:2:635;3413:18;;3400:32;;-1:-1:-1;3484:2:635;3469:18;;3456:32;3526:15;;3519:23;3507:36;;3497:64;;3557:1;3554;3547:12;3497:64;2933:868;;;;-1:-1:-1;2933:868:635;;3660:3;3645:19;;3632:33;;3764:3;3749:19;;;3736:33;;-1:-1:-1;2933:868:635;-1:-1:-1;;2933:868:635:o;3806:225::-;3873:9;;;3894:11;;;3891:134;;;3947:10;3942:3;3938:20;3935:1;3928:31;3982:4;3979:1;3972:15;4010:4;4007:1;4000:15;3891:134;3806:225;;;;:::o;4036:127::-;4097:10;4092:3;4088:20;4085:1;4078:31;4128:4;4125:1;4118:15;4152:4;4149:1;4142:15;4350:138;4429:13;;4451:31;4429:13;4451:31;:::i;:::-;4350:138;;;:::o;4493:976::-;4606:6;4666:3;4654:9;4645:7;4641:23;4637:33;4682:2;4679:22;;;4697:1;4694;4687:12;4679:22;-1:-1:-1;4746:2:635;4740:9;4788:3;4776:16;;4822:18;4807:34;;4843:22;;;4804:62;4801:185;;;4908:10;4903:3;4899:20;4896:1;4889:31;4943:4;4940:1;4933:15;4971:4;4968:1;4961:15;4801:185;5002:2;4995:22;5041:40;5071:9;5041:40;:::i;:::-;5026:56;;5144:2;5129:18;;;5123:25;5164:15;;;5157:30;5220:49;5265:2;5250:18;;5220:49;:::i;:::-;5215:2;5207:6;5203:15;5196:74;5303:49;5348:2;5337:9;5333:18;5303:49;:::i;:::-;5298:2;5290:6;5286:15;5279:74;5387:50;5432:3;5421:9;5417:19;5387:50;:::i;:::-;5381:3;5369:16;;5362:76;5373:6;4493:976;-1:-1:-1;;;4493:976:635:o;5682:230::-;5752:6;5805:2;5793:9;5784:7;5780:23;5776:32;5773:52;;;5821:1;5818;5811:12;5773:52;-1:-1:-1;5866:16:635;;5682:230;-1:-1:-1;5682:230:635:o;5917:273::-;5985:6;6038:2;6026:9;6017:7;6013:23;6009:32;6006:52;;;6054:1;6051;6044:12;6006:52;6086:9;6080:16;6136:4;6129:5;6125:16;6118:5;6115:27;6105:55;;6156:1;6153;6146:12","linkReferences":{},"immutableReferences":{"125443":[{"start":258,"length":32},{"start":930,"length":32}]}},"methodIdentifiers":{"allowedExecutors(address)":"37cb6736","calculateCostBasisView(address,address,uint256)":"e4367cd3","previewFees(address,address,uint256,uint256,uint256)":"49b1df7b","superLedgerConfiguration()":"825e9ec7","updateAccounting(address,address,bytes32,bool,uint256,uint256)":"fd8cd53f","usersAccumulatorCostBasis(address,address)":"e70833d3","usersAccumulatorShares(address,address)":"2c119fca"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.30+commit.73712a01\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"ledgerConfiguration_\",\"type\":\"address\"},{\"internalType\":\"address[]\",\"name\":\"allowedExecutors_\",\"type\":\"address[]\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"FEE_NOT_SET\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"HOOK_NOT_FOUND\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"INVALID_FEE_PERCENT\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"INVALID_LEDGER\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"INVALID_PRICE\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"MANAGER_NOT_SET\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"NOT_AUTHORIZED\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"NOT_MANAGER\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"ZERO_ADDRESS_NOT_ALLOWED\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"ZERO_ID_NOT_ALLOWED\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"ZERO_LENGTH\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"yieldSourceOracle\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"pps\",\"type\":\"uint256\"}],\"name\":\"AccountingInflow\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"yieldSourceOracle\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"feeAmount\",\"type\":\"uint256\"}],\"name\":\"AccountingOutflow\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"originalVal\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"cappedVal\",\"type\":\"uint256\"}],\"name\":\"UsedSharesCapped\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"executor\",\"type\":\"address\"}],\"name\":\"allowedExecutors\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"isAllowed\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"usedShares\",\"type\":\"uint256\"}],\"name\":\"calculateCostBasisView\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"costBasis\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"shares\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"yieldSourceAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amountAssets\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"usedShares\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"feePercent\",\"type\":\"uint256\"}],\"name\":\"previewFees\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"feeAmount\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"superLedgerConfiguration\",\"outputs\":[{\"internalType\":\"contract SuperLedgerConfiguration\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"},{\"internalType\":\"bytes32\",\"name\":\"yieldSourceOracleId\",\"type\":\"bytes32\"},{\"internalType\":\"bool\",\"name\":\"isInflow\",\"type\":\"bool\"},{\"internalType\":\"uint256\",\"name\":\"amountSharesOrAssets\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"usedShares\",\"type\":\"uint256\"}],\"name\":\"updateAccounting\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"feeAmount\",\"type\":\"uint256\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"}],\"name\":\"usersAccumulatorCostBasis\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"costBasis\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"yieldSource\",\"type\":\"address\"}],\"name\":\"usersAccumulatorShares\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"shares\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Superform Labs\",\"details\":\"Extends BaseLedger to modify the fee calculation logic for reward scenarios      Unlike the base implementation, this ledger ignores the cost basis and treats the      entire amount as profit subject to the fee percentage\",\"events\":{\"AccountingInflow(address,address,address,uint256,uint256)\":{\"params\":{\"amount\":\"The amount of shares being added\",\"pps\":\"The price per share at the time of inflow (in asset terms)\",\"user\":\"The user whose ledger is being updated\",\"yieldSource\":\"The yield-bearing asset being accounted for\",\"yieldSourceOracle\":\"The oracle providing price information\"}},\"AccountingOutflow(address,address,address,uint256,uint256)\":{\"params\":{\"amount\":\"The amount of shares or assets being processed\",\"feeAmount\":\"The performance fee charged on yield profit\",\"user\":\"The user whose ledger is being updated\",\"yieldSource\":\"The yield-bearing asset being accounted for\",\"yieldSourceOracle\":\"The oracle providing price information\"}},\"UsedSharesCapped(uint256,uint256)\":{\"params\":{\"cappedVal\":\"The capped amount of shares used\",\"originalVal\":\"The original amount of shares used\"}}},\"kind\":\"dev\",\"methods\":{\"calculateCostBasisView(address,address,uint256)\":{\"details\":\"Cost basis represents the original asset value of the shares when they were acquired      This is calculated proportionally based on the shares being consumed      Formula: user_cost_basis * (used_shares / total_shares)\",\"params\":{\"usedShares\":\"The amount of shares to calculate cost basis for\",\"user\":\"The user address whose cost basis is being calculated\",\"yieldSource\":\"The yield source address (e.g. aUSDC, cUSDC, etc.)\"},\"returns\":{\"costBasis\":\"The original asset value of the specified shares\",\"shares\":\"The amount of shares that will be consumed\"}},\"constructor\":{\"params\":{\"allowedExecutors_\":\"Array of addresses authorized to execute accounting operations\",\"ledgerConfiguration_\":\"Address of the SuperLedgerConfiguration contract\"}},\"previewFees(address,address,uint256,uint256,uint256)\":{\"details\":\"Used to estimate fees before executing a transaction      Fee calculation: fee = (current_value - cost_basis) * fee_percent / 10_000      Returns 0 if there is no profit (current_value <= cost_basis)\",\"params\":{\"amountAssets\":\"The amount of assets retrieved from shares (current value)\",\"feePercent\":\"The fee percentage in basis points (0-10000, where 10000 = 100%)\",\"usedShares\":\"The amount of shares used to obtain the assets\",\"user\":\"The user address whose fees are being calculated\",\"yieldSourceAddress\":\"The yield source address (e.g. aUSDC, cUSDC, etc.)\"},\"returns\":{\"feeAmount\":\"The amount of fee to be collected in the asset being withdrawn\"}},\"updateAccounting(address,address,bytes32,bool,uint256,uint256)\":{\"details\":\"For inflows, records new shares at current price; for outflows, calculates fees based on profit      Only authorized executors can call this function      For outflows, the fee is calculated as a percentage of the profit:      profit = (current_value - cost_basis) where current_value is based on oracle price\",\"params\":{\"amountSharesOrAssets\":\"The amount of shares (for inflow) or assets (for outflow)\",\"isInflow\":\"Whether this is an inflow (true) or outflow (false)\",\"usedShares\":\"The amount of shares used for outflow calculation (0 for inflows)\",\"user\":\"The user address whose accounting is being updated\",\"yieldSource\":\"The yield source address (e.g. aUSDC, cUSDC, etc.)\",\"yieldSourceOracleId\":\"ID for looking up the oracle configuration for this yield source\"},\"returns\":{\"feeAmount\":\"The amount of fee to be collected in the asset being withdrawn (0 for inflows)\"}}},\"title\":\"FlatFeeLedger\",\"version\":1},\"userdoc\":{\"errors\":{\"FEE_NOT_SET()\":[{\"notice\":\"Thrown when attempting to charge a fee without a valid fee percentage\"}],\"HOOK_NOT_FOUND()\":[{\"notice\":\"Thrown when a referenced hook cannot be found\"}],\"INVALID_FEE_PERCENT()\":[{\"notice\":\"Thrown when setting a fee percentage outside the allowed range\"}],\"INVALID_LEDGER()\":[{\"notice\":\"Thrown when an operation references an invalid ledger\"}],\"INVALID_PRICE()\":[{\"notice\":\"Thrown when a price returned from an oracle is invalid (typically zero)\"}],\"MANAGER_NOT_SET()\":[{\"notice\":\"Thrown when a manager is required but not set\"}],\"NOT_AUTHORIZED()\":[{\"notice\":\"Thrown when an unauthorized address attempts a restricted operation\"}],\"NOT_MANAGER()\":[{\"notice\":\"Thrown when a non-manager address attempts a manager-only operation\"}],\"ZERO_ADDRESS_NOT_ALLOWED()\":[{\"notice\":\"Thrown when a critical address parameter is set to the zero address\"}],\"ZERO_ID_NOT_ALLOWED()\":[{\"notice\":\"Thrown when an ID parameter is set to zero\"}],\"ZERO_LENGTH()\":[{\"notice\":\"Thrown when providing an empty array where at least one element is required\"}]},\"events\":{\"AccountingInflow(address,address,address,uint256,uint256)\":{\"notice\":\"Emitted when shares are added to a user's ledger\"},\"AccountingOutflow(address,address,address,uint256,uint256)\":{\"notice\":\"Emitted when shares are consumed from a user's ledger\"},\"UsedSharesCapped(uint256,uint256)\":{\"notice\":\"Emitted when the amount of shares used is capped due to insufficient shares\"}},\"kind\":\"user\",\"methods\":{\"allowedExecutors(address)\":{\"notice\":\"Tracks which addresses are allowed to execute accounting operations\"},\"calculateCostBasisView(address,address,uint256)\":{\"notice\":\"Calculates the cost basis for a given user and amount of shares without modifying state\"},\"constructor\":{\"notice\":\"Initializes the FlatFeeLedger with configuration and executor permissions\"},\"previewFees(address,address,uint256,uint256,uint256)\":{\"notice\":\"Previews fees for a given amount of assets obtained from shares without modifying state\"},\"superLedgerConfiguration()\":{\"notice\":\"The configuration contract that stores yield source oracle settings\"},\"updateAccounting(address,address,bytes32,bool,uint256,uint256)\":{\"notice\":\"Updates accounting for a user's yield source interaction\"},\"usersAccumulatorCostBasis(address,address)\":{\"notice\":\"Tracks the total cost basis (in asset terms) for each user's yield source position\"},\"usersAccumulatorShares(address,address)\":{\"notice\":\"Tracks the total shares each user has for each yield source\"}},\"notice\":\"Specialized ledger implementation that applies a flat fee to reward distributions\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/accounting/FlatFeeLedger.sol\":\"FlatFeeLedger\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"none\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@ERC4337/=lib/modulekit/node_modules/@ERC4337/\",\":@account-abstraction/=lib/modulekit/node_modules/account-abstraction/contracts/\",\":@gnosis.pm/=lib/modulekit/node_modules/@gnosis.pm/\",\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":@pendle/=lib/pendle-core-v2-public/contracts/\",\":@pigeon/=lib/pigeon/src/\",\":@prb/math/=lib/modulekit/node_modules/@prb/math/src/\",\":@rhinestone/=lib/modulekit/node_modules/@rhinestone/\",\":@safe-global/=lib/safe7579/node_modules/@safe-global/\",\":@safe/=lib/safe-smart-account/contracts/\",\":@safe7579/=lib/safe7579/src/\",\":@solady/=lib/solady/\",\":@stringutils/=lib/solidity-stringutils/src/\",\":@surl/=lib/surl/src/\",\":ExcessivelySafeCall/=lib/ExcessivelySafeCall/src/\",\":account-abstraction-v0.6/=lib/modulekit/node_modules/@ERC4337/account-abstraction-v0.6/contracts/\",\":account-abstraction/=lib/modulekit/node_modules/@ERC4337/account-abstraction/contracts/\",\":ds-test/=lib/modulekit/node_modules/ds-test/src/\",\":erc4337-validation/=lib/modulekit/node_modules/@rhinestone/erc4337-validation/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":erc7579/=lib/safe7579/node_modules/erc7579/src/\",\":excessively-safe-call/=lib/modulekit/node_modules/excessively-safe-call/\",\":excessivelySafeCall/=lib/ExcessivelySafeCall/src/\",\":forge-std/=lib/forge-std/src/\",\":halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/\",\":hardhat-deploy/=lib/modulekit/node_modules/hardhat-deploy/\",\":hardhat/=lib/modulekit/node_modules/hardhat/\",\":module-bases/=lib/safe7579/node_modules/@rhinestone/module-bases/src/\",\":modulekit/=lib/modulekit/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":pendle-core-v2-public/=lib/pendle-core-v2-public/contracts/\",\":pigeon/=lib/pigeon/src/\",\":safe-smart-account/=lib/safe-smart-account/\",\":safe7579/=lib/safe7579/src/\",\":sentinellist/=lib/safe7579/node_modules/@rhinestone/sentinellist/src/\",\":solady/=lib/solady/src/\",\":solarray/=lib/modulekit/node_modules/solarray/src/\",\":solidity-stringutils/=lib/solidity-stringutils/\",\":surl/=lib/surl/\"]},\"sources\":{\"lib/openzeppelin-contracts/contracts/utils/Panic.sol\":{\"keccak256\":\"0xf7fe324703a64fc51702311dc51562d5cb1497734f074e4f483bfb6717572d7a\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://c6a5ff4f9fd8649b7ee20800b7fa387d3465bd77cf20c2d1068cd5c98e1ed57a\",\"dweb:/ipfs/QmVSaVJf9FXFhdYEYeCEfjMVHrxDh5qL4CGkxdMWpQCrqG\"]},\"lib/openzeppelin-contracts/contracts/utils/math/Math.sol\":{\"keccak256\":\"0x1225214420c83ebcca88f2ae2b50f053aaa7df7bd684c3e878d334627f2edfc6\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://6c5fab4970634f9ab9a620983dc1c8a30153981a0b1a521666e269d0a11399d3\",\"dweb:/ipfs/QmVRnBC575MESGkEHndjujtR7qub2FzU9RWy9eKLp4hPZB\"]},\"lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol\":{\"keccak256\":\"0x195533c86d0ef72bcc06456a4f66a9b941f38eb403739b00f21fd7c1abd1ae54\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://b1d578337048cad08c1c03041cca5978eff5428aa130c781b271ad9e5566e1f8\",\"dweb:/ipfs/QmPFKL2r9CBsMwmUqqdcFPfHZB2qcs9g1HDrPxzWSxomvy\"]},\"src/accounting/BaseLedger.sol\":{\"keccak256\":\"0x16105e0f76ac4951a8d9f75ef6a2fcf64d3cda3cc9a805cafa0b0b6b7be79d2d\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://374a424ba4447d5ea98e94ccea9cf2110425aebc16773389be852a6fd4cba0d1\",\"dweb:/ipfs/QmSkRkSWP1fa4z3SJT62x76tzH76Lc5zXBt5K3TU3KgZ8L\"]},\"src/accounting/FlatFeeLedger.sol\":{\"keccak256\":\"0xb0179249ab360635cbd69c74a859a24043219cf0e779902558b9d485d5e3c36a\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://36c08b26aea53f0e90cdbcacb2b1d061c2325401b18e99083ef2a98ffcbbddcb\",\"dweb:/ipfs/QmZhmZZRs5jcV8b12ddRqxM114qHoBrsUB8rKdxXgLa5PW\"]},\"src/accounting/SuperLedgerConfiguration.sol\":{\"keccak256\":\"0xdfc8c77f0f9228d72fdd67370e49419bda45e33786c193c7f16ee08cc612e055\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://24cf336b4f7210ea49e647d325a4f8dba0a681eda8e0d0fdd702ec07c50632df\",\"dweb:/ipfs/Qmax24PPUgrF7v4LM8imtH3fRCY2GY6DK7eBxrFazrVZna\"]},\"src/interfaces/accounting/ISuperLedger.sol\":{\"keccak256\":\"0x4ecde59c7dd801fabd8a82b8a5ae629187ae2196bacb3553233a9822c180b01e\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://0fb12bb556c165c5074c767468e358904d76a42e6504d32ed26fba472a4c1b0f\",\"dweb:/ipfs/QmcVmmZxsR1i54Usnt2f9BrnEaE15qZ5bHyiXrSYjruhPa\"]},\"src/interfaces/accounting/ISuperLedgerConfiguration.sol\":{\"keccak256\":\"0x3976b16711cb62051b4887484dcdd7745c844fa7f857635f64382abfb1a67cef\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://697d9a18bae41a8c28a60a8f9b27704912a6d98be1285b1561ceac66e5f182b0\",\"dweb:/ipfs/QmTV1izHhv5xykVsFNwdJGwm7KMcchcqUdisR7KFkNdm9a\"]},\"src/interfaces/accounting/IYieldSourceOracle.sol\":{\"keccak256\":\"0x113e709e86796e7728631db23040bc98ef8164bbad4e8b664a5351a6d6a7dc7a\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://42f4144c16d751105342629c9035c333688d2a78a50269b527ed702ab5d2b9c5\",\"dweb:/ipfs/QmP2ETg1mp5dXv9giytwTaWHhAQUbfs4tic1djExTduaCG\"]},\"src/vendor/awesome-oracles/IOracle.sol\":{\"keccak256\":\"0xfcf929f625459daf5b50f0d761039ab2f9bb2534c7466c5e2db2a4aaf91d9e3e\",\"license\":\"UNLICENSED\",\"urls\":[\"bzz-raw://82c4ced57f865a0abbc6905fea058e85df5cee71529e74a32a995ab559757dcf\",\"dweb:/ipfs/QmPdUizMczjzYJLaXRWH7HuyRo4TtD4icKfioGBDHKDBvp\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.30+commit.73712a01"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"ledgerConfiguration_","type":"address"},{"internalType":"address[]","name":"allowedExecutors_","type":"address[]"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"type":"error","name":"FEE_NOT_SET"},{"inputs":[],"type":"error","name":"HOOK_NOT_FOUND"},{"inputs":[],"type":"error","name":"INVALID_FEE_PERCENT"},{"inputs":[],"type":"error","name":"INVALID_LEDGER"},{"inputs":[],"type":"error","name":"INVALID_PRICE"},{"inputs":[],"type":"error","name":"MANAGER_NOT_SET"},{"inputs":[],"type":"error","name":"NOT_AUTHORIZED"},{"inputs":[],"type":"error","name":"NOT_MANAGER"},{"inputs":[],"type":"error","name":"ZERO_ADDRESS_NOT_ALLOWED"},{"inputs":[],"type":"error","name":"ZERO_ID_NOT_ALLOWED"},{"inputs":[],"type":"error","name":"ZERO_LENGTH"},{"inputs":[{"internalType":"address","name":"user","type":"address","indexed":true},{"internalType":"address","name":"yieldSourceOracle","type":"address","indexed":true},{"internalType":"address","name":"yieldSource","type":"address","indexed":true},{"internalType":"uint256","name":"amount","type":"uint256","indexed":false},{"internalType":"uint256","name":"pps","type":"uint256","indexed":false}],"type":"event","name":"AccountingInflow","anonymous":false},{"inputs":[{"internalType":"address","name":"user","type":"address","indexed":true},{"internalType":"address","name":"yieldSourceOracle","type":"address","indexed":true},{"internalType":"address","name":"yieldSource","type":"address","indexed":true},{"internalType":"uint256","name":"amount","type":"uint256","indexed":false},{"internalType":"uint256","name":"feeAmount","type":"uint256","indexed":false}],"type":"event","name":"AccountingOutflow","anonymous":false},{"inputs":[{"internalType":"uint256","name":"originalVal","type":"uint256","indexed":false},{"internalType":"uint256","name":"cappedVal","type":"uint256","indexed":false}],"type":"event","name":"UsedSharesCapped","anonymous":false},{"inputs":[{"internalType":"address","name":"executor","type":"address"}],"stateMutability":"view","type":"function","name":"allowedExecutors","outputs":[{"internalType":"bool","name":"isAllowed","type":"bool"}]},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"address","name":"yieldSource","type":"address"},{"internalType":"uint256","name":"usedShares","type":"uint256"}],"stateMutability":"view","type":"function","name":"calculateCostBasisView","outputs":[{"internalType":"uint256","name":"costBasis","type":"uint256"},{"internalType":"uint256","name":"shares","type":"uint256"}]},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"address","name":"yieldSourceAddress","type":"address"},{"internalType":"uint256","name":"amountAssets","type":"uint256"},{"internalType":"uint256","name":"usedShares","type":"uint256"},{"internalType":"uint256","name":"feePercent","type":"uint256"}],"stateMutability":"view","type":"function","name":"previewFees","outputs":[{"internalType":"uint256","name":"feeAmount","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"superLedgerConfiguration","outputs":[{"internalType":"contract SuperLedgerConfiguration","name":"","type":"address"}]},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"address","name":"yieldSource","type":"address"},{"internalType":"bytes32","name":"yieldSourceOracleId","type":"bytes32"},{"internalType":"bool","name":"isInflow","type":"bool"},{"internalType":"uint256","name":"amountSharesOrAssets","type":"uint256"},{"internalType":"uint256","name":"usedShares","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"updateAccounting","outputs":[{"internalType":"uint256","name":"feeAmount","type":"uint256"}]},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"address","name":"yieldSource","type":"address"}],"stateMutability":"view","type":"function","name":"usersAccumulatorCostBasis","outputs":[{"internalType":"uint256","name":"costBasis","type":"uint256"}]},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"address","name":"yieldSource","type":"address"}],"stateMutability":"view","type":"function","name":"usersAccumulatorShares","outputs":[{"internalType":"uint256","name":"shares","type":"uint256"}]}],"devdoc":{"kind":"dev","methods":{"calculateCostBasisView(address,address,uint256)":{"details":"Cost basis represents the original asset value of the shares when they were acquired      This is calculated proportionally based on the shares being consumed      Formula: user_cost_basis * (used_shares / total_shares)","params":{"usedShares":"The amount of shares to calculate cost basis for","user":"The user address whose cost basis is being calculated","yieldSource":"The yield source address (e.g. aUSDC, cUSDC, etc.)"},"returns":{"costBasis":"The original asset value of the specified shares","shares":"The amount of shares that will be consumed"}},"constructor":{"params":{"allowedExecutors_":"Array of addresses authorized to execute accounting operations","ledgerConfiguration_":"Address of the SuperLedgerConfiguration contract"}},"previewFees(address,address,uint256,uint256,uint256)":{"details":"Used to estimate fees before executing a transaction      Fee calculation: fee = (current_value - cost_basis) * fee_percent / 10_000      Returns 0 if there is no profit (current_value <= cost_basis)","params":{"amountAssets":"The amount of assets retrieved from shares (current value)","feePercent":"The fee percentage in basis points (0-10000, where 10000 = 100%)","usedShares":"The amount of shares used to obtain the assets","user":"The user address whose fees are being calculated","yieldSourceAddress":"The yield source address (e.g. aUSDC, cUSDC, etc.)"},"returns":{"feeAmount":"The amount of fee to be collected in the asset being withdrawn"}},"updateAccounting(address,address,bytes32,bool,uint256,uint256)":{"details":"For inflows, records new shares at current price; for outflows, calculates fees based on profit      Only authorized executors can call this function      For outflows, the fee is calculated as a percentage of the profit:      profit = (current_value - cost_basis) where current_value is based on oracle price","params":{"amountSharesOrAssets":"The amount of shares (for inflow) or assets (for outflow)","isInflow":"Whether this is an inflow (true) or outflow (false)","usedShares":"The amount of shares used for outflow calculation (0 for inflows)","user":"The user address whose accounting is being updated","yieldSource":"The yield source address (e.g. aUSDC, cUSDC, etc.)","yieldSourceOracleId":"ID for looking up the oracle configuration for this yield source"},"returns":{"feeAmount":"The amount of fee to be collected in the asset being withdrawn (0 for inflows)"}}},"version":1},"userdoc":{"kind":"user","methods":{"allowedExecutors(address)":{"notice":"Tracks which addresses are allowed to execute accounting operations"},"calculateCostBasisView(address,address,uint256)":{"notice":"Calculates the cost basis for a given user and amount of shares without modifying state"},"constructor":{"notice":"Initializes the FlatFeeLedger with configuration and executor permissions"},"previewFees(address,address,uint256,uint256,uint256)":{"notice":"Previews fees for a given amount of assets obtained from shares without modifying state"},"superLedgerConfiguration()":{"notice":"The configuration contract that stores yield source oracle settings"},"updateAccounting(address,address,bytes32,bool,uint256,uint256)":{"notice":"Updates accounting for a user's yield source interaction"},"usersAccumulatorCostBasis(address,address)":{"notice":"Tracks the total cost basis (in asset terms) for each user's yield source position"},"usersAccumulatorShares(address,address)":{"notice":"Tracks the total shares each user has for each yield source"}},"version":1}},"settings":{"remappings":["@ERC4337/=lib/modulekit/node_modules/@ERC4337/","@account-abstraction/=lib/modulekit/node_modules/account-abstraction/contracts/","@gnosis.pm/=lib/modulekit/node_modules/@gnosis.pm/","@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/","@pendle/=lib/pendle-core-v2-public/contracts/","@pigeon/=lib/pigeon/src/","@prb/math/=lib/modulekit/node_modules/@prb/math/src/","@rhinestone/=lib/modulekit/node_modules/@rhinestone/","@safe-global/=lib/safe7579/node_modules/@safe-global/","@safe/=lib/safe-smart-account/contracts/","@safe7579/=lib/safe7579/src/","@solady/=lib/solady/","@stringutils/=lib/solidity-stringutils/src/","@surl/=lib/surl/src/","ExcessivelySafeCall/=lib/ExcessivelySafeCall/src/","account-abstraction-v0.6/=lib/modulekit/node_modules/@ERC4337/account-abstraction-v0.6/contracts/","account-abstraction/=lib/modulekit/node_modules/@ERC4337/account-abstraction/contracts/","ds-test/=lib/modulekit/node_modules/ds-test/src/","erc4337-validation/=lib/modulekit/node_modules/@rhinestone/erc4337-validation/src/","erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/","erc7579/=lib/safe7579/node_modules/erc7579/src/","excessively-safe-call/=lib/modulekit/node_modules/excessively-safe-call/","excessivelySafeCall/=lib/ExcessivelySafeCall/src/","forge-std/=lib/forge-std/src/","halmos-cheatcodes/=lib/openzeppelin-contracts/lib/halmos-cheatcodes/src/","hardhat-deploy/=lib/modulekit/node_modules/hardhat-deploy/","hardhat/=lib/modulekit/node_modules/hardhat/","module-bases/=lib/safe7579/node_modules/@rhinestone/module-bases/src/","modulekit/=lib/modulekit/src/","openzeppelin-contracts/=lib/openzeppelin-contracts/","pendle-core-v2-public/=lib/pendle-core-v2-public/contracts/","pigeon/=lib/pigeon/src/","safe-smart-account/=lib/safe-smart-account/","safe7579/=lib/safe7579/src/","sentinellist/=lib/safe7579/node_modules/@rhinestone/sentinellist/src/","solady/=lib/solady/src/","solarray/=lib/modulekit/node_modules/solarray/src/","solidity-stringutils/=lib/solidity-stringutils/","surl/=lib/surl/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"none"},"compilationTarget":{"src/accounting/FlatFeeLedger.sol":"FlatFeeLedger"},"evmVersion":"prague","libraries":{}},"sources":{"lib/openzeppelin-contracts/contracts/utils/Panic.sol":{"keccak256":"0xf7fe324703a64fc51702311dc51562d5cb1497734f074e4f483bfb6717572d7a","urls":["bzz-raw://c6a5ff4f9fd8649b7ee20800b7fa387d3465bd77cf20c2d1068cd5c98e1ed57a","dweb:/ipfs/QmVSaVJf9FXFhdYEYeCEfjMVHrxDh5qL4CGkxdMWpQCrqG"],"license":"MIT"},"lib/openzeppelin-contracts/contracts/utils/math/Math.sol":{"keccak256":"0x1225214420c83ebcca88f2ae2b50f053aaa7df7bd684c3e878d334627f2edfc6","urls":["bzz-raw://6c5fab4970634f9ab9a620983dc1c8a30153981a0b1a521666e269d0a11399d3","dweb:/ipfs/QmVRnBC575MESGkEHndjujtR7qub2FzU9RWy9eKLp4hPZB"],"license":"MIT"},"lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol":{"keccak256":"0x195533c86d0ef72bcc06456a4f66a9b941f38eb403739b00f21fd7c1abd1ae54","urls":["bzz-raw://b1d578337048cad08c1c03041cca5978eff5428aa130c781b271ad9e5566e1f8","dweb:/ipfs/QmPFKL2r9CBsMwmUqqdcFPfHZB2qcs9g1HDrPxzWSxomvy"],"license":"MIT"},"src/accounting/BaseLedger.sol":{"keccak256":"0x16105e0f76ac4951a8d9f75ef6a2fcf64d3cda3cc9a805cafa0b0b6b7be79d2d","urls":["bzz-raw://374a424ba4447d5ea98e94ccea9cf2110425aebc16773389be852a6fd4cba0d1","dweb:/ipfs/QmSkRkSWP1fa4z3SJT62x76tzH76Lc5zXBt5K3TU3KgZ8L"],"license":"Apache-2.0"},"src/accounting/FlatFeeLedger.sol":{"keccak256":"0xb0179249ab360635cbd69c74a859a24043219cf0e779902558b9d485d5e3c36a","urls":["bzz-raw://36c08b26aea53f0e90cdbcacb2b1d061c2325401b18e99083ef2a98ffcbbddcb","dweb:/ipfs/QmZhmZZRs5jcV8b12ddRqxM114qHoBrsUB8rKdxXgLa5PW"],"license":"Apache-2.0"},"src/accounting/SuperLedgerConfiguration.sol":{"keccak256":"0xdfc8c77f0f9228d72fdd67370e49419bda45e33786c193c7f16ee08cc612e055","urls":["bzz-raw://24cf336b4f7210ea49e647d325a4f8dba0a681eda8e0d0fdd702ec07c50632df","dweb:/ipfs/Qmax24PPUgrF7v4LM8imtH3fRCY2GY6DK7eBxrFazrVZna"],"license":"Apache-2.0"},"src/interfaces/accounting/ISuperLedger.sol":{"keccak256":"0x4ecde59c7dd801fabd8a82b8a5ae629187ae2196bacb3553233a9822c180b01e","urls":["bzz-raw://0fb12bb556c165c5074c767468e358904d76a42e6504d32ed26fba472a4c1b0f","dweb:/ipfs/QmcVmmZxsR1i54Usnt2f9BrnEaE15qZ5bHyiXrSYjruhPa"],"license":"Apache-2.0"},"src/interfaces/accounting/ISuperLedgerConfiguration.sol":{"keccak256":"0x3976b16711cb62051b4887484dcdd7745c844fa7f857635f64382abfb1a67cef","urls":["bzz-raw://697d9a18bae41a8c28a60a8f9b27704912a6d98be1285b1561ceac66e5f182b0","dweb:/ipfs/QmTV1izHhv5xykVsFNwdJGwm7KMcchcqUdisR7KFkNdm9a"],"license":"Apache-2.0"},"src/interfaces/accounting/IYieldSourceOracle.sol":{"keccak256":"0x113e709e86796e7728631db23040bc98ef8164bbad4e8b664a5351a6d6a7dc7a","urls":["bzz-raw://42f4144c16d751105342629c9035c333688d2a78a50269b527ed702ab5d2b9c5","dweb:/ipfs/QmP2ETg1mp5dXv9giytwTaWHhAQUbfs4tic1djExTduaCG"],"license":"Apache-2.0"},"src/vendor/awesome-oracles/IOracle.sol":{"keccak256":"0xfcf929f625459daf5b50f0d761039ab2f9bb2534c7466c5e2db2a4aaf91d9e3e","urls":["bzz-raw://82c4ced57f865a0abbc6905fea058e85df5cee71529e74a32a995ab559757dcf","dweb:/ipfs/QmPdUizMczjzYJLaXRWH7HuyRo4TtD4icKfioGBDHKDBvp"],"license":"UNLICENSED"}},"version":1},"id":324}